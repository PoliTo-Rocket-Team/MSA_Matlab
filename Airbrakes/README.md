# Air Brakes Sim Mini Guide
This readme file is intented to serve as a brief guide to better understand how to run theAir Brakes Control System (ABCS) simulator

## Option 1:  Using the already computed variables
To simply run the simulator using the already computed variables, run `sim_start.m`

A message will display if the required .mat files have loaded successfully and the `airbrake_sim.slx` will automatically open, ready for simulation

## Option 1:  Using freshly generated variables
Should the user wish to alter some of the simulation parameters, another option is to generate all the required variables manually 

To do so, start by running `step0_initialize_values.m` 

The messages displayed in the command line will guide the user through the generation of all the required variables by running, subsequently, `step1_simtime_calculator_script.m` and `step2_trajectories_sim_script.m`

At the end of each script, the user will be prompted to choose whether they want to save the newly generated variables to the respective .mat files

At the end of this process, `airbrake_sim.slx` will automatically open, ready for simulation

N.B. Additional information on which variables can be tuned and on the pre-requirements to run the each script can be found at the top of each file, in MatLab comment form 




## Additional info
### Code generation
The `codegen_model.slx` schematic represents the ABCS model without the ThreeDoF model for code generation purposes

`codegen_start.m` acts like `sim_start.m`, loading the required variables for code generation and opening the code generation schematic

The model takes the altitude and the vertical velocity values fed by the in-flight computer and outputs the calculated air brakes extension value

With the Simulink Coder toolbox installed, adequate settings for code generation can be chosen through the Simulink settings panel for the aforementioned model

### PSO PID tuning
The `PSO_script.m` is used for generating the decision variables of the PID through particle swarm optimization

Basic (fundamental) info regarding its use can be found at the top the script, in MatLab comment form

To tune the PID, follow these steps:

1 - Once simulation variables are set, a wide starting constraint (example case: 1 to 100) should be set for all four variables, with a sufficient number of iterations (>10)

2 - Run the script and observe the output P, I, D and N variables value:

2.1 - If the generated PID variables are within the the previously set constraints, narrow the constraints to a value closer to that generated by the script itself (example case: if the P value is 20 after the first run, modify the constraints to 15-25 or similar)
    
2.2 - If, instead, a variable matches its lower/upper constraint (example case: the optimal P value is shown to be 100), relax the lower/upper bound of said constraint (example case: bring the upper bound of P to 500)

3 - Repeat from step 2 and keep narrowing the bounds (when results fall inside case 2.1) to narrow down the optimal PID decision variables until reasonable (example case: until the first decimal of the decision variables does not change after the script has been run)

4 - Save the generated variables into `pid_var.mat` using the commented save command found at the end of the script (manually enter it into MatLab's console)

5 - To avert conflict with the process variables generated by the PSO script, **after saving the decision variables through the previous step**, run and verify the new variables through the `sim_start.m` script

### Lookup table(s) generation
The `lookup_table_gen` folder contains the file pertaining to the generation of the lookup table(s) which correlates mach number, cd and air brakes extension

Due to the lack of need to frequently alter the lookup table(s), these files are kept separated from the main sim folder

The lookup table(s) are generated through MatLab's Curve Fitter tool, additional documentation on the procedure can be found on the air brakes control system report

